!function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=36)}({36:function(e,t,n){e.exports=n(37)},37:function(e,t,n){n(38),n(39),n(40),n(41)},38:function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}window.chunkUpload=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.request_limit=1e3,this.url=t,this.file=document.querySelector("#ova-file").files[0],this.reader=new FileReader,this.getTotalChunks(1024*n)>this.request_limit?this.chunk_size=1024*this.getChunkSize():this.chunk_size=1024*n,this.curr_chunk=0,this.total_chunks=this.getTotalChunks(this.chunk_size),this.final=!1}var t,a,i;return t=e,(a=[{key:"getChunkSize",value:function(){return Math.ceil(this.file.size/(1024*this.request_limit))}},{key:"getTotalChunks",value:function(e){return Math.ceil(this.file.size/e)}},{key:"upload_file",value:function(e,t){var n=e+t.chunk_size+1,a=t.file.slice(e,n),i=!1,o=!1;this.reader.onloadend=function(e){e.target.readyState===FileReader.DONE&&(t.curr_chunk==t.total_chunks-1?i=!0:0==t.curr_chunk&&(o=!0),$.ajax({url:t.url,type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},dataType:"text",cache:!1,data:{file_data:e.target.result,file:t.file.name,file_type:t.file.type,first_chunk:o,final_chunk:i},error:function(e,t,n){console.log(e,t,n)},success:function(e){t.curr_chunk++;var a=Math.floor(t.curr_chunk/t.total_chunks*100);$('[id*="-progress"]').css("width",a+"%"),i&&location.reload(),n<t.file.size&&t.upload_file(n,t)}}))},this.reader.readAsDataURL(a)}}])&&n(t.prototype,a),i&&n(t,i),e}(),window.ovaSelectorScript=function(e,t){var n=$("#ova-file").val().split("\\");if(n[n.length-1]==t+".ova"){var a=new window.chunkUpload(e,1e4);a.upload_file(0,a)}else alert("OVA File must be labeled the same name as the Machine. Please select a file with the name: "+t+".ova.")},window.zipSelectorScript=function(e,t){var n=$("#ova-file").val().split("\\");if(n[n.length-1]==t+".zip"){var a=new window.chunkUpload(e,1e4);a.upload_file(0,a)}else alert("Zip File must be labeled the same name as the Machine. Please select a file with the name: "+t+".zip.")}},39:function(e,t){function n(e){$.ajax({url:"/teacher/get/vbox/vminfo/"+window.convertName(e),type:"get",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){o(e.status),e.registered?($("#vm-register-state").text("Machine is Registered."),$("#register-vm").hide(),$("#unregister-vm").show(),$("#vm-network-table").show(),$("#vm-power").show(),e["NIC 1"].includes("Bridged")?($("#vm-network-mode").val("Bridged"),$(".vm-bridged").show(),$("#vm-bridged-adapter").val(e["NIC 1"].split("'")[1])):e["NIC 1"].includes("NAT")&&($("#vm-network-mode").val("NAT"),$(".vm-bridged").hide())):($("#vm-register-state").text("Machine is not yet registered."),$("#unregister-vm").hide(),$("#register-vm").show(),$("#vm-network-table").hide(),$("#vm-power").hide())},error:function(e){console.log(e)}})}function a(e){$("#"+e).empty(),spinner='<div class="spinner-border text-primary" role="status"><span class="sr-only"></span></div>',$("#"+e).append(spinner)}function o(e){$("#vm-status").empty(),e?$("#vm-status").append('<i class="fas fa-power-off fa-2x text-primary"></i>'):$("#vm-status").append('<i class="fas fa-power-off  fa-2x text-danger"></i>')}$(document).on("click",".delete-model",(function(){var e=$(this).data("name"),t=$(this).data("type");$.ajax({url:"/teacher/delete/"+t+"/"+e,type:"post",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){location.reload()},error:function(e){console.log(e)}})})),$(document).on("click","#collapse-skills",(function(){$("#collapse-skills-icon").attr("class").includes("compress")?($("#edit-skills").hide(),$("#collapse-skills-icon").attr("class","fas fa-expand-arrows-alt")):($("#edit-skills").show(),$("#collapse-skills-icon").attr("class","fas fa-compress-arrows-alt"))})),$(document).on("click","#add-new-skill",(function(){modeltype=$("#type-header").data("model-type"),name=$("#edit-vm-name").text(),skill=$("#new-skill").val(),$.ajax({url:"/teacher/create/vmskill/"+name,type:"post",data:{skill:skill},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){window.getModelInfo(modeltype,name)},error:function(e){console.log(e)}})})),$(document).on("click",".delete-skill",(function(){modeltype=$("#type-header").data("model-type"),name=$("#edit-vm-name").text(),skill=$("#new-skill").val(),skillId=$(this).attr("id").split("-")[2],$.ajax({url:"/teacher/delete/vmskill/"+name,type:"post",data:{id:skillId},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){window.getModelInfo(modeltype,name)},error:function(e){console.log(e)}})})),$(document).on("show.bs.modal","#uploadOvaModal",(function(e){var t=$(e.relatedTarget),n=window.convertName(t.data("name"));$("#ova-file").attr("onchange","window.ovaSelectorScript('http://www.ocl.dev/teacher/upload/chunkupload','"+n+"')")})),$(document).on("show.bs.modal","#uploadZipModal",(function(e){var t=$(e.relatedTarget),n=window.convertName(t.data("name"));$("#ova-file").attr("onchange","window.zipSelectorScript('http://www.ocl.dev/teacher/upload/zipupload','"+n+"')")})),$(document).on("click","#delete-ova",(function(){var e=window.convertName($("#edit-vm-name").text());$.ajax({url:"/teacher/delete/vm/file/"+e,type:"post",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){location.reload()},error:function(e){console.log(e)}})})),$(document).on("click",".vmmanage-modal",(function(e){var t=$(this).data("name"),a=$("#vmManageModal");a.modal("show"),a.find(".modal-title").text("Manage "+t+" Virtual Machine"),a.data("name",t),$.ajax({url:"/teacher/get/vbox/interfaces",type:"get",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){for($("#vm-bridged-adapter").empty(),i=0;i<e.length;i++)$("#vm-bridged-adapter").append("<option value="+e[i]+">"+e[i]+"</option.")},error:function(e){console.log(e)}}),n(t)})),$(document).on("hide.bs.modal","#vmManageModal",(function(){location.reload()})),$(document).on("click","#modify-network-mode",(function(){var e=$("#vmManageModal").data("name"),t=$("#vm-network-mode").val();$.ajax({url:"/teacher/set/vbox/network/"+window.convertName(e),type:"post",data:{"vm-network-mode":t},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){alert(t.message),n(e)},error:function(e){console.log(e)}})})),$(document).on("click","#modify-bridged-adapter",(function(){var e=$("#vmManageModal").data("name"),t=$("#vm-bridged-adapter").val();$.ajax({url:"/teacher/set/vbox/bridged/"+window.convertName(e),type:"post",data:{"vm-bridged-adapter":t},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){alert(t.message),n(e)},error:function(e){console.log(e)}})})),$(document).on("click","#vm-power-toggle",(function(){var e=$("#vmManageModal").data("name");a("vm-status"),$.ajax({url:"/teacher/set/vbox/power/"+window.convertName(e),type:"post",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){o(e.status)},error:function(e){json=e.responseJSON,o(json.status)}})})),$(document).on("click","#vm-reset",(function(){var e=$("#vmManageModal").data("name");a("vm-status"),$.ajax({url:"/teacher/set/vbox/reset/"+window.convertName(e),type:"post",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){o(e.status)},error:function(e){json=e.responseJSON,o(json.status)}})})),$(document).on("click","#unregister-vm",(function(){var e=$("#vmManageModal").data("name");$.ajax({url:"/teacher/set/vbox/unregister/"+window.convertName(e),type:"post",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){alert(e.message),location.reload()},error:function(e){json=e.responseJSON,alert(json.message),location.reload()}})})),$(document).on("click","#register-vm",(function(){var e=$("#vmManageModal").data("name");$.ajax({url:"/teacher/set/vbox/register/"+window.convertName(e),type:"post",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){location.reload()},error:function(e){console.log(e)}})})),window.getModelInfo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e.includes("hints")){var a=$("#edit-"+e).attr("action");a="/"+a.split("/")[1]+"/"+a.split("/")[2]+"/"+a.split("/")[3]+"/",$("#edit-"+e).attr("action",a+t)}var i="/teacher/get/"+e+"/"+t;$.ajax({url:i,type:"get",data:{page:n},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(n){e.includes("hints")?e.includes("b2r")?window.updateB2RHintModal(n,t):e.includes("lab")&&($("#add-new-hint-form").attr("data-levels",n.levels),window.updateLabHintModal(n.hints,t,n.levels)):window.updateModelView(e,n)},error:function(e){console.log(e)}})},window.updateModelView=function(e,t){if("b2r"==e||"lab"==e){if(vm=t[e],$("#edit-vm-name").text(vm.name),$("#edit-pts").val(vm.points),$("#edit-ip").val(vm.ip),$("#edit-file-name").text(vm.file),$("#edit-os-select").val(vm.os),$("#edit-icon-picker").val(vm.icon),$("#edit-description").val(vm.description),"b2r"==e&&($("#edit-root-flag").val(vm.flags.root_flag),$("#edit-user-flag").val(vm.flags.user_flag)),"lab"==e)window.clearLevelFlags(),t[e].flags.forEach((function(e,t,n){window.makeLevelLineItem(e.level,e.id,t==n.length-1),$("#level-flag-"+e.level).val(e.flag)}));window.makeSkillLineItems(t[e].skills),window.updateSkillItems(t[e].skills)}else $("#ctf-name").text(t.name),$("#edit-category").val(t.category),$("#edit-description").val(t.description),$("#edit-file-name").text(t.file),$("#edit-flag").val(t.flag),$("#edit-pts").val(t.points),$("#edit-icon-picker").val(t.icon)},window.updateB2RHintModal=function(e,t){levels=0,e.forEach((function(e,t){window.makeHintRow(e,t,"b2r",levels),window.populateHintRow(e,"b2r",t)}))},window.updateLabHintModal=function(e,t,n){$("#edit-hints-table").empty(),window.makePagination(e.last_page),data=e.data,currentPage=e.current_page,$("#hint-page-nav").attr("data-current",currentPage),data.forEach((function(e,t){window.makeHintRow(e,t,"lab",n),window.populateHintRow(e,"lab",t)})),$("#hint-page-"+currentPage).attr("class","page-item active")},window.updateLevelItem=function(e,t){window.makeLevelLineItem(e.level,e.id),$("#level-flag-"+e.level).val(e.flag)},window.clearLevelFlags=function(){$("#level-flags-body").empty()},window.makeLevelLineItem=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];idLabel="level-flag-"+e,html='<tr><td><label for="'+idLabel+'" class="my-1">Level '+e+" Flag</label>\n",html=html+'<input type="text" class="form-control" id="'+idLabel+'" name="flag-'+e+'"></td>\n',n?html=html+'<td><button type="button" class="btn btn-primary my-4 delete-level" data-id="'+t+'"><i class="fas fa-trash-alt"></i></button></td></tr>':html+="<td></td></tr>",$("#level-flags-body").append(html)},window.makeSkillLineItems=function(e){for($("#skills-body").empty(),skillSelect=($.ajax({url:"/teacher/get/skills",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){skills=e},async:!1}),html="",skills.forEach((function(e,t){html=html+'<option value="'+e.name+'">'+e.name+"</option>\n"})),html),i=1;i<=e.length;i++)html='<tr><td><label class="my-2">Skill #'+i+"</label>\n",html=html+'<select name="skill-'+e[i-1].id+'" id="skill-'+e[i-1].id+'" class="form-control mx-1">\n',html+=skillSelect,html=html+'</select></td><td class="align-bottom">\n<button type="button" class="mx-2 btn btn-primary delete-skill" id="delete-skill-'+e[i-1].id+'"><i class="fas fa-trash-alt"></i></button>\n</td>\n</tr>',$("#skills-body").append(html);html='<tr><td ><label class="my-2">Add New Skill</label>\n<select name="new-skill" id="new-skill" class="form-control mx-1">\n',html+=skillSelect,html+='</select></td>\n<td class="align-bottom">\n<button type="button" class="mx-2 btn btn-primary align-middle" id="add-new-skill"><i class="fas fa-plus"></i></button>\n</td>\n</tr>',$("#skills-body").append(html)},window.updateSkillItems=function(e){e.forEach((function(e,t){$("#skill-"+e.id).val(e.skill)}))},window.convertName=function(e){return e.toLowerCase().replace(/ /g,"_")}},40:function(e,t){$(document).ready((function(){}))},41:function(e,t){$(document).ready((function(){$(".edit-hints-modal").click((function(e){$("#edit-hints-table").empty(),$("#editHintsModal").modal("show");var t=$(this).data("name"),n=$("#type-header").data("model-type"),a=$("#edit-hints").attr("action");$("#edit-hints").attr("data-name",t),$("#edit-hints").attr("action",a+t),$("#editHintsModal").attr("data-name",t),window.getModelInfo(n+"/hints",t)})),$(".close-new-hint").click((function(){$("#new-level").empty(),$("#newHintModal").modal("hide")})),$("#update-hints").click((function(e){var t=[],n=$("#edit-hints").data("name"),a=$("#edit-hints").data("type");$("#edit-hints-table tr").each((function(){var e=$(this).find('[id*="hint-id-"]').val(),n=$(this).find('td [id*="hint-content-"]').val();if("b2r"==a){var i=$(this).find('td [id*="is-root"]').prop("checked");t.push({id:e,hint:n,is_root:i})}else if("lab"==a){var o=$(this).find('td [id*="level-"]').val();t.push({id:e,hint:n,level:o})}})),url="/teacher/update/"+a+"/"+n+"/hints",$.ajax({type:"POST",url:url,data:JSON.stringify(t),headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},dataType:"json",contentType:"application/json",processData:"false",success:function(e){$("#edit-hints-table").empty(),n=$("#edit-hints").data("name"),window.getModelInfo(a+"/hints",n)}})})),$("#create-hint").click((function(){var e=$("#edit-hints").data("type"),t=$("#edit-hints").data("name"),n="/teacher/create/"+e+"/"+t+"/hints",a=$("#new-hint").val();if($("#is-root").length){var i=$("#is-root").prop("checked");$.ajax({url:n,type:"post",data:{hint:a,is_root:i},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(n){$("#new-hint").val(""),$("#newHintModal").modal("hide"),$("#edit-hints-table").empty(),t=$("#edit-hints").data("name"),window.getModelInfo(e+"/hints",t)},error:function(e){console.log(e)}})}else if($("#new-level").length){var o=$("#new-level").val();$.ajax({url:n,type:"post",data:{hint:a,level:o},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(n){$("#new-hint").val(""),$("#newHintModal").modal("hide"),$("#edit-hints-table").empty(),t=$("#edit-hints").data("name"),window.getModelInfo(e+"/hints",t,$("#hint-page-nav").attr("data-current"))},error:function(e){console.log(e)}})}})),$("#newHintModal").on("show.bs.modal",(function(e){window.labHintOptions($("#add-new-hint-form").attr("data-levels"))})),$(document).on("click",".remove-hint",(function(e){id=this.id.substring(12),type=$("#edit-hints").data("type"),url="/teacher/delete/"+type+"/hints/"+id,name=$(this).data("name"),$.ajax({url:url,type:"post",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){$("#edit-hints-table").empty(),$("#hint-page-nav").length?window.getModelInfo(type+"/hints",name,$("#hint-page-nav").attr("data-current")):window.getModelInfo(type+"/hints",name)},error:function(e){console.log(e)}})})),$(document).on("click",".hint-page-link",(function(e){console.log("beep");var t=$(this).text(),n=$("#edit-hints").data("name"),a=$("#type-header").data("model-type");window.getModelInfo(a+"/hints",n,t)}))})),window.makeHintRow=function(e,t,n,a){if(rowId="hint-row-"+t,hintIdLabel="hint-id-"+e.id,hintLabel="hint-content-"+e.id,isRootLabel="is-root-"+e.id,levelLabel="level-"+e.id,buttonLabel="remove-hint-"+e.id,out='<tr id="'+rowId+'">\n<input type="hidden" class="form-control" id="'+hintIdLabel+'" value="'+e.id+'" name="hint-id-'+t+'">\n',out=out+'<td><input type="text" class="form-control" name="'+hintLabel+'"id="'+hintLabel+'"></td>\n',"b2r"==n)out=out+'<td><input type="checkbox" class="form-control" name="'+isRootLabel+'" id="'+isRootLabel+'"></td>\n';else if("lab"==n){for(out=out+'<td><select type="os-select" class="form-control" name="level" id="'+levelLabel+'">\n',i=1;i<=a;i++)out=out+'<option value="'+i+'">'+i+"</option>\n";out+="</select></td>\n"}out=out+'<td><button type="button" class="btn btn-primary remove-hint" id="'+buttonLabel+'" name="'+buttonLabel+'" data-name="'+e[n+"_name"]+'"><i class="fas fa-trash-alt"></i></button\n</tr>\n',$("#edit-hints-table").append(out)},window.labHintOptions=function(e){for($("#new-level").empty(),options="",i=1;i<=e;i++)options=options+'<option value="'+i+'">'+i+"</option>\n";$("#new-level").append(options)},window.populateHintRow=function(e,t,n){hintIdLabel="hint-id-"+e.id,hintLabel="hint-content-"+e.id,isRootLabel="is-root-"+e.id,levelLabel="level-"+e.id,buttonLabel="remove-hint-"+n,$("#"+hintIdLabel).val(e.id),$("#"+hintLabel).val(e.hint),"b2r"==t?$("#"+isRootLabel).attr("checked",1==e.is_root):"lab"==t&&$("#"+levelLabel).val(e.level)},window.makePagination=function(e){for($("#hint-pagination").empty(),p="",i=1;i<=e;i++)p=p+'<li class="page-item" id="hint-page-'+i+'"><button type="button" class="btn btn-primary-trans btn-sm page-link hint-page-link">'+i+"</button></li>";$("#hint-pagination").append(p)}}});